<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ƒêƒÉng nh·∫≠p - Flower'Lna</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

  <!-- Google Font & Custom CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

  <style>
    body {
      background-color: #faf9f7;
      font-family: 'Roboto', sans-serif;
      color: #2f2f2f;
      height: auto;
      min-height: 100vh;
      position: relative;
    }

    /* HEADER */
    header {
      background: #fff;
      border-bottom: 1px solid #eee;
      padding: 15px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      position: relative;
      z-index: 100;
    }

    .logo {
      font-family: 'Playfair Display', serif;
      font-size: 28px;
      color: #b08c3a;
      font-weight: 700;
      letter-spacing: 2px;
    }

    .contact-info {
      text-align: right;
      color: #7c7c7c;
      font-size: 14px;
    }

    /* MENU */
    .navbar {
      background-color: #fff8f0 !important;
      border-top: 1px solid #eee;
      border-bottom: 1px solid #eee;
      position: relative;
      z-index: 100;
    }

    .navbar-nav .nav-link {
      color: #3b2d1f !important;
      font-weight: 500;
      font-size: 16px;
      margin: 0 10px;
      transition: 0.3s;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .navbar-nav .nav-link:hover {
      color: #b08c3a !important;
    }

    /* AUTH SECTION */
    .auth-container {
      min-height: calc(100vh - 200px);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      position: relative;
    }

    .auth-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      width: 100%;
      max-width: 1000px;
      margin: 0 auto;
      height: auto;
      min-height: 550px;
    }

    .auth-image {
      background: url('https://images.unsplash.com/photo-1523348837708-15d4a09cfac2?auto=format&fit=crop&w=800&q=80') center/cover no-repeat;
      height: 100%;
      min-height: 550px;
      position: relative;
    }

    .auth-image::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(176, 140, 58, 0.1) 0%, rgba(212, 175, 55, 0.2) 100%);
    }

    .auth-form {
      padding: 50px 40px;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      overflow-y: auto;
      max-height: none;
    }

    .auth-title {
      font-family: 'Playfair Display', serif;
      font-size: 32px;
      color: #b08c3a;
      margin-bottom: 10px;
      text-align: center;
    }

    .auth-subtitle {
      color: #7c7c7c;
      text-align: center;
      margin-bottom: 30px;
      font-size: 16px;
    }

    .form-control {
      border-radius: 8px;
      padding: 12px 15px;
      border: 1px solid #e0e0e0;
      margin-bottom: 20px;
      transition: 0.3s;
      font-size: 14px;
    }

    .form-control:focus {
      border-color: #b08c3a;
      box-shadow: 0 0 0 0.2rem rgba(176, 140, 58, 0.25);
    }

    .form-check-input:checked {
      background-color: #b08c3a;
      border-color: #b08c3a;
    }

    .form-check-label {
      font-size: 14px;
      color: #5a5a5a;
    }

    .btn-auth {
      background-color: #b08c3a;
      color: white;
      border: none;
      border-radius: 30px;
      padding: 12px 30px;
      font-weight: 600;
      width: 100%;
      transition: 0.3s;
      margin-top: 10px;
    }

    .btn-auth:hover {
      background-color: #d4af37;
      transform: translateY(-2px);
    }

    .btn-auth:disabled {
      background-color: #cccccc;
      transform: none;
    }

    .forgot-password {
      color: #b08c3a;
      text-decoration: none;
      font-size: 14px;
      float: right;
    }

    .forgot-password:hover {
      color: #d4af37;
      text-decoration: underline;
    }

    .auth-switch {
      text-align: center;
      margin-top: 25px;
      color: #7c7c7c;
      font-size: 14px;
    }

    .auth-switch a {
      color: #b08c3a;
      text-decoration: none;
      font-weight: 500;
    }

    .auth-switch a:hover {
      text-decoration: underline;
    }

    .divider {
      display: flex;
      align-items: center;
      margin: 25px 0;
    }

    .divider::before,
    .divider::after {
      content: "";
      flex: 1;
      height: 1px;
      background: #e0e0e0;
    }

    .divider span {
      padding: 0 15px;
      color: #7c7c7c;
      font-size: 14px;
    }

    .social-login {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }

    .social-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 45px;
      height: 45px;
      border-radius: 50%;
      border: 1px solid #e0e0e0;
      background: white;
      color: #555;
      font-size: 18px;
      transition: 0.3s;
    }

    .social-btn:hover {
      background: #f8f8f8;
      transform: translateY(-2px);
      border-color: #b08c3a;
      color: #b08c3a;
    }

    /* Th√¥ng b√°o */
    .alert-custom {
      border-radius: 8px;
      border: none;
      padding: 12px 15px;
      margin-bottom: 20px;
    }

    /* Loading spinner */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid #b08c3a;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 8px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Vai tr√≤ ƒëƒÉng nh·∫≠p */
    .vai-tro-dang-nhap {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .vai-tro-btn {
      flex: 1;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      padding: 10px;
      background: white;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }

    .vai-tro-btn:hover {
      border-color: #b08c3a;
      background-color: #fff8f0;
    }

    .vai-tro-btn.selected {
      border-color: #b08c3a;
      background-color: #fff8f0;
      box-shadow: 0 2px 8px rgba(176, 140, 58, 0.2);
    }

    .vai-tro-icon {
      font-size: 18px;
      color: #b08c3a;
      margin-bottom: 5px;
    }

    .vai-tro-text {
      font-size: 12px;
      font-weight: 600;
      color: #2f2f2f;
    }

    /* FOOTER */
    footer {
      background: #1e1a16;
      color: #d4c7a0;
      text-align: center;
      padding: 40px 0;
      margin-top: auto;
      width: 100%;
      position: relative;
    }

    footer h5 {
      font-family: 'Playfair Display', serif;
      font-size: 20px;
      margin-bottom: 15px;
    }

    footer p {
      font-size: 14px;
      color: #b9a97d;
    }

    footer a {
      color: #d4af37;
      text-decoration: none;
      margin: 0 10px;
      font-size: 18px;
    }

    footer a:hover {
      color: #fff;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .auth-image {
        min-height: 300px;
      }
      
      .auth-form {
        padding: 30px 25px;
      }
      
      .auth-container {
        padding: 20px 15px;
        min-height: calc(100vh - 150px);
      }
    }

    @media (max-width: 576px) {
      .auth-form {
        padding: 25px 20px;
      }
      
      .auth-title {
        font-size: 28px;
      }
      
      .auth-container {
        padding: 15px 10px;
      }
    }

    /* Layout */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    .page-wrapper {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
  </style>
</head>
<body>
  <div class="page-wrapper">

  <!-- HEADER -->
  <header class="container-fluid">
    <div class="container d-flex justify-content-between align-items-center">
      <a href="index.html" class="logo text-decoration-none">üå∏ Flower'Lna</a>
      <div class="contact-info">
        Hotline: <strong>1800 88 88 88</strong><br>
        Flower'Lna.vn | contact@FlowerLna.vn
      </div>
    </div>
  </header>

  <!-- MENU -->
  <nav class="navbar navbar-expand-lg navbar-light">
    <div class="container">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="index.html">Trang ch·ªß</a></li>
          <li class="nav-item"><a class="nav-link" href="#">B·ªô s∆∞u t·∫≠p</a></li>
          <li class="nav-item"><a class="nav-link" href="#">D·ªãch v·ª•</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Khuy·∫øn m√£i</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Li√™n h·ªá</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- AUTH SECTION -->
  <section class="auth-container">
    <div class="container">
      <div class="row auth-card">
        <!-- H√¨nh ·∫£nh trang tr√≠ -->
        <div class="col-md-6 p-0">
          <div class="auth-image"></div>
        </div>
        
        <!-- Form ƒëƒÉng nh·∫≠p -->
        <div class="col-md-6 p-0">
          <div class="auth-form">
            <h2 class="auth-title">ƒêƒÉng nh·∫≠p</h2>
            <p class="auth-subtitle">Ch√†o m·ª´ng tr·ªü l·∫°i v·ªõi Flower'Lna</p>

            <!-- Th√¥ng b√°o -->
            <div id="thongBao"></div>
            
            <!-- Ch·ªçn vai tr√≤ ƒëƒÉng nh·∫≠p -->
            <div class="mb-3">
              <label class="form-label fw-semibold">ƒêƒÉng nh·∫≠p v·ªõi t∆∞ c√°ch:</label>
              <div class="vai-tro-dang-nhap">
                <div class="vai-tro-btn selected" data-vai-tro="khachhang">
                  <div class="vai-tro-icon">
                    <i class="bi bi-person"></i>
                  </div>
                  <div class="vai-tro-text">Kh√°ch h√†ng</div>
                </div>
                <div class="vai-tro-btn" data-vai-tro="quantri">
                  <div class="vai-tro-icon">
                    <i class="bi bi-shield-check"></i>
                  </div>
                  <div class="vai-tro-text">Admin</div>
                </div>
              </div>
              <input type="hidden" id="vaiTroDangNhap" value="khachhang">
            </div>
            
            <form id="formDangNhap">
              <div class="mb-3">
                <input type="email" class="form-control" id="email" placeholder="Email" required>
              </div>
              <div class="mb-3">
                <input type="password" class="form-control" id="matKhau" placeholder="M·∫≠t kh·∫©u" required>
              </div>
              <div class="mb-3 d-flex justify-content-between align-items-center">
                <div class="form-check">
                  <input type="checkbox" class="form-check-input" id="ghiNhoDangNhap">
                  <label class="form-check-label" for="ghiNhoDangNhap">Ghi nh·ªõ ƒëƒÉng nh·∫≠p</label>
                </div>
                <a href="#" class="forgot-password">Qu√™n m·∫≠t kh·∫©u?</a>
              </div>
              <button type="submit" class="btn btn-auth" id="btnDangNhap">
                ƒêƒÉng nh·∫≠p
              </button>
            </form>
            
            <div class="divider">
              <span>Ho·∫∑c ƒëƒÉng nh·∫≠p v·ªõi</span>
            </div>
            
            <div class="social-login">
              <a href="#" class="social-btn"><i class="bi bi-facebook"></i></a>
              <a href="#" class="social-btn"><i class="bi bi-google"></i></a>
              <a href="#" class="social-btn"><i class="bi bi-twitter"></i></a>
            </div>
            
            <div class="auth-switch">
              Ch∆∞a c√≥ t√†i kho·∫£n? <a href="register.html" id="switchToRegister">ƒêƒÉng k√Ω ngay</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <h5>Flower'Lna - Hoa Th∆∞·ª£ng L∆∞u</h5>
      <p>ƒê·ªãa ch·ªâ: 88 Nguy·ªÖn Hu·ªá, Qu·∫≠n 1, TP.HCM<br>
      Hotline: 1800 88 88 88 | Email: contact@FlowerLna.vn</p>
      <div>
        <a href="#"><i class="bi bi-facebook"></i></a>
        <a href="#"><i class="bi bi-instagram"></i></a>
        <a href="#"><i class="bi bi-twitter"></i></a>
      </div>
      <p class="mt-3">&copy; 2025 Flower'Lna. All Rights Reserved.</p>
    </div>
  </footer>

  </div>

  <!-- Bootstrap JS + jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    $(document).ready(function() {
      // H√†m hi·ªÉn th·ªã th√¥ng b√°o
      function hienThiThongBao(noiDung, loai = 'success') {
        const thongBao = $('#thongBao');
        const lopCSS = loai === 'success' ? 'alert-success' : loai === 'error' ? 'alert-danger' : 'alert-info';
        const icon = loai === 'success' ? 'bi-check-circle' : 'bi-exclamation-triangle';
        
        thongBao.html(`
          <div class="alert ${lopCSS} alert-custom alert-dismissible fade show" role="alert">
            <i class="bi ${icon} me-2"></i>${noiDung}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        `).show();
      }

      // X·ª≠ l√Ω ch·ªçn vai tr√≤
      $('.vai-tro-btn').click(function() {
        $('.vai-tro-btn').removeClass('selected');
        $(this).addClass('selected');
        const vaiTro = $(this).data('vai-tro');
        $('#vaiTroDangNhap').val(vaiTro);
        
        if (vaiTro === 'quantri') {
          $('#email').attr('placeholder', 'Email admin');
          hienThiThongBao('B·∫°n ƒëang ƒëƒÉng nh·∫≠p v·ªõi t∆∞ c√°ch Qu·∫£n tr·ªã vi√™n', 'info');
        } else {
          $('#email').attr('placeholder', 'Email');
        }
      });

      // X·ª≠ l√Ω form ƒëƒÉng nh·∫≠p
      $('#formDangNhap').submit(function(e) {
        e.preventDefault();
        
        const email = $('#email').val().trim();
        const matKhau = $('#matKhau').val();
        const vaiTroDangNhap = $('#vaiTroDangNhap').val();
        
        if (!email || !matKhau) {
          hienThiThongBao('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß email v√† m·∫≠t kh·∫©u', 'error');
          return;
        }
        
        const btn = $('#btnDangNhap');
        btn.prop('disabled', true).html('<div class="loading-spinner"></div> ƒêang ƒëƒÉng nh·∫≠p...');
        
        console.log('üîÑ ƒêang g·ª≠i request ƒëƒÉng nh·∫≠p...', { 
          email: email, 
          vaiTroDangNhap: vaiTroDangNhap 
        });
        
        // G·ªçi API ƒëƒÉng nh·∫≠p
        $.ajax({
          url: '../api/nguoidung.php',
          type: 'POST',
          contentType: 'application/json',
          data: JSON.stringify({
            Email: email,
            MatKhau: matKhau,
            dangNhap: true
          }),
          success: function(response) {
            console.log('‚úÖ Ph·∫£n h·ªìi t·ª´ server:', response);
            
            // X·ª≠ l√Ω response th√†nh c√¥ng
            if (response.thanhCong) {
              const vaiTroNguoiDung = response.nguoiDung.VaiTro;
              const vaiTroDaChon = vaiTroDangNhap;
              
              console.log('üîë Vai tr√≤ ng∆∞·ªùi d√πng:', vaiTroNguoiDung);
              console.log('üéØ Vai tr√≤ ƒë√£ ch·ªçn:', vaiTroDaChon);
              
              // Ki·ªÉm tra quy·ªÅn truy c·∫≠p
              if (vaiTroNguoiDung !== vaiTroDaChon) {
                hienThiThongBao(`T√†i kho·∫£n n√†y kh√¥ng c√≥ quy·ªÅn ƒëƒÉng nh·∫≠p v·ªõi vai tr√≤ ${vaiTroDaChon === 'quantri' ? 'Admin' : 'Kh√°ch h√†ng'}`, 'error');
                btn.prop('disabled', false).html('ƒêƒÉng nh·∫≠p');
                return;
              }
              
              hienThiThongBao(response.thongBao || 'ƒêƒÉng nh·∫≠p th√†nh c√¥ng!', 'success');
              
              // L∆∞u th√¥ng tin v√†o localStorage
              localStorage.setItem('nguoiDung', JSON.stringify(response.nguoiDung));
              localStorage.setItem('daDangNhap', 'true');
              localStorage.setItem('vaiTroDangNhap', vaiTroDaChon);
              
              console.log('üíæ ƒê√£ l∆∞u v√†o localStorage:', {
                nguoiDung: response.nguoiDung,
                daDangNhap: 'true'
              });
              
              // Ghi nh·ªõ ƒëƒÉng nh·∫≠p
              if ($('#ghiNhoDangNhap').is(':checked')) {
                localStorage.setItem('ghiNhoDangNhap', 'true');
              }
              
              // Chuy·ªÉn h∆∞·ªõng sau 1 gi√¢y
              setTimeout(() => {
                if (response.nguoiDung.VaiTro === 'quantri') {
                  console.log('üöÄ Chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang qu·∫£n l√Ω');
                  window.location.href = 'quanli.html';
                } else {
                  console.log('üè† Chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang ch·ªß');
                  window.location.href = 'index.html';
                }
              }, 1000);
              
            } else {
              // X·ª≠ l√Ω l·ªói t·ª´ server
              console.error('‚ùå L·ªói t·ª´ server:', response.loi);
              hienThiThongBao(response.loi || 'ƒêƒÉng nh·∫≠p th·∫•t b·∫°i', 'error');
              btn.prop('disabled', false).html('ƒêƒÉng nh·∫≠p');
            }
          },
          error: function(xhr, status, error) {
            console.error('‚ùå L·ªói AJAX:', {
              status: status,
              error: error,
              responseText: xhr.responseText
            });
            
            let thongBaoLoi = 'L·ªói k·∫øt n·ªëi server';
            try {
              const phucHoiLoi = JSON.parse(xhr.responseText);
              thongBaoLoi = phucHoiLoi.error || phucHoiLoi.loi || thongBaoLoi;
            } catch (e) {
              thongBaoLoi = xhr.responseText || thongBaoLoi;
            }
            
            hienThiThongBao(thongBaoLoi, 'error');
            btn.prop('disabled', false).html('ƒêƒÉng nh·∫≠p');
          }
        });
      });

      // Chuy·ªÉn ƒë·∫øn trang ƒëƒÉng k√Ω
      $('#switchToRegister').click(function(e) {
        e.preventDefault();
        window.location.href = 'register.html';
      });

      // X·ª≠ l√Ω qu√™n m·∫≠t kh·∫©u
      $('.forgot-password').click(function(e) {
        e.preventDefault();
        hienThiThongBao('T√≠nh nƒÉng qu√™n m·∫≠t kh·∫©u s·∫Ω ƒë∆∞·ª£c ph√°t tri·ªÉn sau. Vui l√≤ng li√™n h·ªá qu·∫£n tr·ªã vi√™n.', 'error');
      });

      // Ki·ªÉm tra n·∫øu ƒë√£ ƒëƒÉng nh·∫≠p
      const daDangNhap = localStorage.getItem('daDangNhap');
      const nguoiDung = localStorage.getItem('nguoiDung');
      
      if (daDangNhap === 'true' && nguoiDung) {
        try {
          const thongTinNguoiDung = JSON.parse(nguoiDung);
          console.log('üëã ƒê√£ ƒëƒÉng nh·∫≠p v·ªõi:', thongTinNguoiDung.HoTen);
        } catch (e) {
          console.error('L·ªói parse th√¥ng tin ng∆∞·ªùi d√πng:', e);
        }
      }
    });
  </script>
</body>
</html> 