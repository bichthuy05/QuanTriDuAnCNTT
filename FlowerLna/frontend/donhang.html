<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Qu·∫£n l√Ω ƒê∆°n h√†ng - Flower'Lna</title>

<!-- Bootstrap CSS + Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

<style>
body { background-color: #faf9f7; font-family: 'Roboto', sans-serif; color: #2f2f2f; }
header { background: #fff; border-bottom: 1px solid #eee; padding: 15px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.05);}
.logo { font-family: 'Playfair Display', serif; font-size: 28px; color: #b08c3a; font-weight: 700; letter-spacing: 2px;}
.navbar { background-color: #fff8f0 !important; border-top: 1px solid #eee; border-bottom: 1px solid #eee;}
.navbar-nav .nav-link { color: #3b2d1f !important; font-weight: 500; font-size: 16px; margin: 0 10px; transition: 0.3s;}
.navbar-nav .nav-link:hover { color: #b08c3a !important;}
.sidebar { background: #fff; border-right: 1px solid #eee; box-shadow: 2px 0 8px rgba(0,0,0,0.05); min-height: calc(100vh - 140px);}
.sidebar .nav-link { color: #3b2d1f; padding: 15px 20px; margin: 5px 15px; border-radius: 8px; font-weight: 500; transition: 0.3s;}
.sidebar .nav-link:hover { background-color: #fff8f0; color: #b08c3a;}
.sidebar .nav-link.active { background: linear-gradient(135deg,#b08c3a,#d4af37); color: white;}
.main-content { background: #faf9f7; padding: 30px; }
.page-header { background: white; border-radius: 12px; padding: 25px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);}
.page-title { font-family: 'Playfair Display', serif; font-size: 32px; color: #b08c3a;}
.btn-primary-custom { background: linear-gradient(135deg,#b08c3a,#d4af37); border:none; border-radius:25px; padding:10px 25px; color:white; font-weight:600; }
.btn-primary-custom:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(176,140,58,0.4);}
.table-modern { background:white; border-radius:12px; overflow:hidden; box-shadow:0 4px 15px rgba(0,0,0,0.08);}
.table-modern thead { background: linear-gradient(135deg,#b08c3a,#d4af37); color:white;}
</style>
</head>

<body>
<!-- HEADER -->
<header class="container-fluid">
  <div class="container d-flex justify-content-between align-items-center">
    <a href="index.html" class="logo text-decoration-none">üå∏ Flower'Lna</a>
    <div class="contact-info">Hotline: <strong>1800 88 88 88</strong><br>FlowerLna.vn | contact@FlowerLna.vn</div>
  </div>
</header>

<!-- MENU -->
<nav class="navbar navbar-expand-lg navbar-light">
  <div class="container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link" href="index.html">Trang ch·ªß</a></li>
        <li class="nav-item"><a class="nav-link" href="#">B·ªô s∆∞u t·∫≠p</a></li>
        <li class="nav-item"><a class="nav-link" href="#">D·ªãch v·ª•</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Li√™n h·ªá</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- MAIN -->
<div class="container-fluid">
  <div class="row">
    <!-- SIDEBAR -->
    <div class="col-md-3 col-lg-2 sidebar">
      <div class="sidebar-header text-center p-3 border-bottom">
        <h5>üå∏ Flower'Lna</h5><small class="text-muted">Admin Panel</small>
      </div>
      <nav class="nav flex-column mt-3">
        <a class="nav-link" href="quanli.html"><i class="bi bi-speedometer2"></i> Dashboard</a>
        <a class="nav-link" href="hoa.html"><i class="bi bi-flower1"></i> Qu·∫£n l√Ω Hoa</a>
        <a class="nav-link" href="loaihoa.html"><i class="bi bi-tags"></i> Lo·∫°i Hoa</a>
        <a class="nav-link" href="khachhang.html"><i class="bi bi-people"></i> Kh√°ch h√†ng</a>
        <a class="nav-link active" href="donhang.html"><i class="bi bi-box-seam"></i> ƒê∆°n h√†ng</a>
      </nav>
    </div>

    <!-- CONTENT -->
    <div class="col-md-9 col-lg-10 main-content">
      <div class="page-header">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h1 class="page-title">Qu·∫£n l√Ω ƒê∆°n h√†ng</h1>
            <p class="page-subtitle text-muted">Theo d√µi v√† qu·∫£n l√Ω t·∫•t c·∫£ ƒë∆°n h√†ng c·ªßa kh√°ch h√†ng</p>
          </div>
          <button class="btn btn-primary-custom" data-bs-toggle="modal" data-bs-target="#modalKhachHang">
            <i class="bi bi-search me-2"></i> T√¨m kh√°ch h√†ng
          </button>
        </div>
      </div>

      <!-- Search -->
      <div class="row mb-3">
        <div class="col-md-6">
          <div class="input-group">
            <input type="text" id="searchOrder" class="form-control" placeholder="T√¨m ƒë∆°n h√†ng theo m√£ ho·∫∑c kh√°ch h√†ng...">
            <button class="btn btn-outline-secondary"><i class="bi bi-search"></i></button>
          </div>
        </div>
      </div>

      <!-- TABLE -->
      <div class="card">
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover table-modern align-middle">
              <thead>
                <tr>
                  <th>M√£ ƒê∆°n</th>
                  <th>Kh√°ch h√†ng</th>
                  <th>T·ªïng ti·ªÅn</th>
                  <th>Tr·∫°ng th√°i</th>
                  <th class="text-center">Thao t√°c</th>
                </tr>
              </thead>
              <tbody id="tbodyDonHang">
                <tr>
                  <td colspan="5" class="text-center py-4 text-muted">ƒêang t·∫£i d·ªØ li·ªáu...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer class="text-center mt-5 py-4 bg-dark text-light">
  <h5>Flower'Lna - Hoa Th∆∞·ª£ng L∆∞u</h5>
  <p>ƒê·ªãa ch·ªâ: 88 Nguy·ªÖn Hu·ªá, Qu·∫≠n 1, TP.HCM<br>Hotline: 1800 88 88 88 | Email: contact@FlowerLna.vn</p>
  <p>&copy; 2025 Flower'Lna. All Rights Reserved.</p>
</footer>

<!-- MODAL KH√ÅCH H√ÄNG -->
<div class="modal fade" id="modalKhachHang" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Danh s√°ch Kh√°ch h√†ng</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="input-group mb-3">
          <input type="text" id="searchCustomer" class="form-control" placeholder="T√¨m theo t√™n ho·∫∑c s·ªë ƒëi·ªán tho·∫°i...">
          <button class="btn btn-outline-secondary"><i class="bi bi-search"></i></button>
        </div>
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>T√™n kh√°ch h√†ng</th>
                <th>S·ªë ƒëi·ªán tho·∫°i</th>
                <th>Email</th>
                <th>ƒê·ªãa ch·ªâ</th>
              </tr>
            </thead>
            <tbody id="tbodyKhachHang">
              <tr><td colspan="4" class="text-center text-muted">ƒêang t·∫£i d·ªØ li·ªáu...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- JS -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
const API_BASE_URL = '../api';

function loadDonHang() {
  $.get(API_BASE_URL + '/donhang.php', function(data) {
    const tbody = $('#tbodyDonHang');
    tbody.empty();
    if (!data || data.length === 0) {
      tbody.append('<tr><td colspan="5" class="text-center text-muted">Kh√¥ng c√≥ ƒë∆°n h√†ng</td></tr>');
      return;
    }
    data.forEach(d => {
      tbody.append(`
        <tr>
          <td>#${d.MaDon}</td>
          <td>${d.TenKhach || 'N/A'}</td>
          <td>${formatCurrency(d.TongTien)}</td>
          <td><span class="badge ${getStatusClass(d.TrangThai)}">${d.TrangThai}</span></td>
          <td class="text-center">
            <button class="btn btn-sm btn-warning"><i class="bi bi-eye"></i></button>
            <button class="btn btn-sm btn-danger"><i class="bi bi-trash"></i></button>
          </td>
        </tr>
      `);
    });
  }).fail(()=>$('#tbodyDonHang').html('<tr><td colspan="5" class="text-center text-danger">L·ªói t·∫£i d·ªØ li·ªáu</td></tr>'));
}

function loadKhachHang() {
  $.get(API_BASE_URL + '/khachhang.php', function(data) {
    const tbody = $('#tbodyKhachHang');
    tbody.empty();
    if (!data || data.length === 0) {
      tbody.append('<tr><td colspan="4" class="text-center text-muted">Kh√¥ng c√≥ kh√°ch h√†ng</td></tr>');
      return;
    }
    data.forEach(k => {
      tbody.append(`
        <tr>
          <td>${k.HoTen}</td>
          <td>${k.SoDienThoai}</td>
          <td>${k.Email}</td>
          <td>${k.DiaChi || ''}</td>
        </tr>
      `);
    });
  });
}

function formatCurrency(v) {
  return new Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'}).format(v||0);
}
function getStatusClass(status){
  if(status==='ƒê√£ giao') return 'bg-success';
  if(status==='ƒêang x·ª≠ l√Ω') return 'bg-warning';
  if(status==='ƒê√£ h·ªßy') return 'bg-danger';
  return 'bg-secondary';
}

$('#searchOrder').on('input',function(){
  const kw=$(this).val().toLowerCase();
  $('#tbodyDonHang tr').each(function(){
    $(this).toggle($(this).text().toLowerCase().includes(kw));
  });
});
$('#searchCustomer').on('input',function(){
  const kw=$(this).val().toLowerCase();
  $('#tbodyKhachHang tr').each(function(){
    $(this).toggle($(this).text().toLowerCase().includes(kw));
  });
});

$(document).ready(()=>{
  loadDonHang();
  loadKhachHang();
});
</script>
</body>
</html>
